\newcounter{BaseCounter}[section]

\NewDocumentCommand\HasSection{}{
  \renewcommand{\theBaseCounter}{\arabic{section}.\arabic{BaseCounter}}
  \renewcommand{\theequation}{\arabic{section}.\arabic{equation}}
}

\NewDocumentCommand\HasChapter{}{
  \renewcommand{\theBaseCounter}{\arabic{chapter}.\arabic{section}.\arabic{BaseCounter}}
  \renewcommand{\theequation}{\arabic{chapter}.\arabic{section}.\arabic{equation}}
}